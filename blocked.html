<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Website Time Manager - Access Blocked</title>
  <link rel="stylesheet" href="blocked-styles.css">
</head>
<body>
  <div class="blocked-container">
    <div class="blocked-icon">🚫</div>
    
    <h1 class="blocked-title">Access Blocked</h1>
    <h2 class="blocked-subtitle" id="site-name">Website</h2>
    
    <p class="blocked-message">
      You've reached your daily time limit for this website. Take a break and try some productive activities instead!
    </p>

    <div class="stats-container">
      <div class="stats-title">Today's Usage</div>
      <div class="stats-grid">
        <div class="stat-item">
          <div class="stat-value" id="time-used">30:00</div>
          <div class="stat-label">Time Used</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="limit-reached">100%</div>
          <div class="stat-label">Limit Reached</div>
        </div>
      </div>
    </div>

    <div class="reset-info">
      <div class="reset-icon">🔄</div>
      <div class="reset-text">Your time limit will reset at midnight</div>
      <div class="countdown" id="countdown">--:--:--</div>
    </div>

    <div class="suggestions">
      <div class="suggestions-title">💡 Try these productive alternatives:</div>
      <ul class="suggestion-list">
        <li class="suggestion-item">
          <span class="suggestion-icon">📚</span>
          <span>Read a book or article</span>
        </li>
        <li class="suggestion-item">
          <span class="suggestion-icon">🏃‍♂️</span>
          <span>Go for a walk or exercise</span>
        </li>
        <li class="suggestion-item">
          <span class="suggestion-icon">🧘</span>
          <span>Practice meditation or mindfulness</span>
        </li>
        <li class="suggestion-item">
          <span class="suggestion-icon">✍️</span>
          <span>Work on a personal project</span>
        </li>
      </ul>
    </div>

    <div class="buttons">
      <button class="btn btn-primary" onclick="openExtensionPopup()">
        View Statistics
      </button>
      <a href="#" class="btn btn-secondary" onclick="window.close(); return false;">
        Close Tab
      </a>
    </div>
  </div>

  <script>
    // Get site from URL parameters
    const urlParams = new URLSearchParams(window.location.search);
    const site = urlParams.get('site') || 'this website';
    
    // Update site name
    document.getElementById('site-name').textContent = formatSiteName(site);
    
    // Format site name for display
    function formatSiteName(site) {
      const names = {
        'youtube.com': 'YouTube',
        'facebook.com': 'Facebook',
        'twitter.com': 'Twitter',
        'instagram.com': 'Instagram',
        'tiktok.com': 'TikTok',
        'reddit.com': 'Reddit'
      };
      return names[site] || site.charAt(0).toUpperCase() + site.slice(1);
    }

    // Update countdown to midnight
    function updateCountdown() {
      const now = new Date();
      const tomorrow = new Date(now);
      tomorrow.setDate(tomorrow.getDate() + 1);
      tomorrow.setHours(0, 0, 0, 0);
      
      const timeDiff = tomorrow.getTime() - now.getTime();
      
      const hours = Math.floor(timeDiff / (1000 * 60 * 60));
      const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);
      
      document.getElementById('countdown').textContent = 
        `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }

    // Load time data with better error handling
    async function loadTimeData() {
      try {
        const response = await chrome.runtime.sendMessage({
          action: 'getTimeData',
          site: site
        });
        
        if (response && response.timeSpent !== undefined) {
          const timeUsedMs = response.timeSpent;
          const hours = Math.floor(timeUsedMs / (60 * 60 * 1000));
          const minutes = Math.floor((timeUsedMs % (60 * 60 * 1000)) / (60 * 1000));
          
          document.getElementById('time-used').textContent = 
            `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
        }
      } catch (error) {
        console.error('Error loading time data:', error);
        // Fallback: keep the default display
      }
    }

    // Open extension popup with better UX
    function openExtensionPopup() {
      // Try to open a new tab to the extension's options page
      try {
        chrome.tabs.create({ url: chrome.runtime.getURL('popup/popup.html') });
      } catch (error) {
        // Fallback: show helpful instructions
        alert('Click the Website Time Manager extension icon in your browser toolbar to view detailed statistics and manage settings.');
      }
    }

    // Initialize
    updateCountdown();
    loadTimeData();
    setInterval(updateCountdown, 1000);

    // Add motivational quotes with better timing
    const quotes = [
      "The best time to plant a tree was 20 years ago. The second best time is now.",
      "Your future self will thank you for the choices you make today.",
      "Small steps in the right direction can turn out to be the biggest step of your life.",
      "Progress, not perfection.",
      "Time is the most valuable thing we have.",
      "Success is the sum of small efforts repeated day in and day out.",
      "The only way to do great work is to love what you do."
    ];

    // Show a random quote after page loads
    setTimeout(() => {
      const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
      const quoteElement = document.createElement('div');
      quoteElement.className = 'quote-container';
      quoteElement.innerHTML = `"${randomQuote}"`;
      document.querySelector('.blocked-container').appendChild(quoteElement);
    }, 2000);

    // Add keyboard shortcuts for better UX
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        window.close();
      } else if (e.key === 'Enter') {
        openExtensionPopup();
      }
    });
  </script>
</body>
</html> 